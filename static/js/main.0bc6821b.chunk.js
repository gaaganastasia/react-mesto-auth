(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{30:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),s=n.n(c),r=n(20),i=n.n(r),o=(n(30),n(22)),l=n(3),u=n(2),d=n.p+"static/media/Union.1b6082f8.svg",p=n.p+"static/media/Union-err.df8eddf6.svg";var m=function(e){return Object(a.jsx)("div",{className:"popup-form ".concat(e.isOpen?"popup_opened":""),children:Object(a.jsxs)("form",{method:"get",action:"index.html",className:"tooltip__container",noValidate:!0,children:[Object(a.jsx)("button",{type:"reset",className:"popup__reset",onClick:e.onClose}),Object(a.jsx)("img",{className:"tooltip__img",src:e.isRegisterSuccess?d:p,alt:e.isRegisterSuccess?"\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e":"\u043e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),Object(a.jsx)("h2",{className:"tooltip__text",children:"".concat(e.isRegisterSuccess?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.")})]})})},h=Object(u.h)((function(e){var t=s.a.useState(""),n=Object(l.a)(t,2),c=n[0],r=n[1],i=s.a.useState(""),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(a.jsxs)("div",{className:"form__container",children:[Object(a.jsx)("h1",{className:"form__header",children:"\u0412\u0445\u043e\u0434"}),Object(a.jsxs)("form",{method:"post",action:"index.html",name:"sign-in",className:"form",onSubmit:function(t){t.preventDefault(),c&&u&&e.onLogin(c,u)},noValidate:!0,children:[Object(a.jsxs)("label",{className:"form__field",htmlFor:"email",children:[Object(a.jsx)("input",{name:"email",type:"text",minLength:"2",maxLength:"30",placeholder:"Email",value:c,onChange:function(e){r(e.target.value)},id:"email",className:"form__input form__input-email",required:!0}),Object(a.jsx)("span",{className:"form__input-error",id:"email-input-error"})]}),Object(a.jsxs)("label",{className:"form__field",htmlFor:"password",children:[Object(a.jsx)("input",{name:"password",type:"password",minLength:"8",maxLength:"30",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u,onChange:function(e){d(e.target.value)},id:"password",className:"form__input form__input-password",required:!0}),Object(a.jsx)("span",{className:"form__input-error",id:"password-input-error"})]}),Object(a.jsx)("button",{type:"submit",className:"form__submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})),j=n(8),f=Object(u.h)((function(e){var t=s.a.useState(""),n=Object(l.a)(t,2),c=n[0],r=n[1],i=s.a.useState(""),o=Object(l.a)(i,2),u=o[0],d=o[1];return Object(a.jsxs)("div",{className:"form__container",children:[Object(a.jsx)("h1",{className:"form__header",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(a.jsxs)("form",{method:"post",action:"index.html",name:"sign-in",className:"form",onSubmit:function(t){t.preventDefault(),c&&u&&e.onRegister(c,u)},noValidate:!0,children:[Object(a.jsxs)("label",{className:"form__field",htmlFor:"email-input",children:[Object(a.jsx)("input",{name:"sign-in",type:"text",minLength:"2",maxLength:"30",placeholder:"Email",value:c,onChange:function(e){r(e.target.value)},id:"email-input",className:"form__input form__input-email"}),Object(a.jsx)("span",{className:"form__input-error",id:"email-input-error"})]}),Object(a.jsxs)("label",{className:"form__field",htmlFor:"password-input",children:[Object(a.jsx)("input",{name:"sign-in",type:"password",minLength:"8",maxLength:"30",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u,onChange:function(e){d(e.target.value)},id:"password-input",className:"form__input form__input-password"}),Object(a.jsx)("span",{className:"form__input-error",id:"password-input-error"})]}),Object(a.jsx)("button",{type:"submit",className:"form__submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(a.jsxs)("p",{className:"form__text",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",Object(a.jsx)(j.b,{to:"/sign-in",className:"form__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})})),_=n.p+"static/media/logo.a307e1c4.svg";var b=function(e){return Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{src:_,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}),Object(a.jsx)(u.b,{exact:!0,path:"/",children:Object(a.jsxs)("p",{className:"header__info",children:[e.userEmail,Object(a.jsx)(j.b,{to:"/sign-in",className:"header__link",onClick:function(){e.onSignOut(),localStorage.removeItem("jwt"),e.history.push("/sign-in")},children:"\u0412\u044b\u0439\u0442\u0438"})]})}),Object(a.jsx)(u.b,{path:"/sign-up",children:Object(a.jsx)("p",{className:"header__info",children:Object(a.jsx)(j.b,{to:"/sign-in",className:"header__link",children:"\u0412\u043e\u0439\u0442\u0438"})})}),Object(a.jsx)(u.b,{path:"/sign-in",children:Object(a.jsx)("p",{className:"header__info",children:Object(a.jsx)(j.b,{to:"/sign-up",className:"header__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})})]})},O=s.a.createContext();var x=function(e){var t=s.a.useContext(O),n=e.card.owner._id===t._id,c="element__delete ".concat(n?"element__delete_shown":""),r=e.card.likes.some((function(e){return e._id===t._id})),i="element__like ".concat(r?"element__like_active":"");return Object(a.jsxs)("div",{className:"elements__element element",children:[Object(a.jsx)("img",{src:e.card.link,alt:"\u0424\u043e\u0442\u043e ".concat(e.card.name),className:"element__image",onClick:e.onCardClick}),Object(a.jsx)("button",{type:"button",className:c,onClick:e.onCardDelete}),Object(a.jsx)("h3",{className:"element__title",children:e.card.name}),Object(a.jsxs)("div",{className:"element__like-container",children:[Object(a.jsx)("button",{type:"button",className:i,onClick:e.onCardLike}),Object(a.jsx)("p",{className:"element__like-counter",children:e.card.likes.length})]})]})};var g=function(e){var t=s.a.useContext(O);return Object(a.jsxs)("main",{className:"main",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__form",children:[Object(a.jsxs)("div",{className:"profile__image-container",onClick:e.onEditAvatar,children:[Object(a.jsx)("img",{src:t.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__image"}),Object(a.jsx)("div",{className:"profile__image-overlay"})]}),Object(a.jsxs)("div",{className:"profile__info info",children:[Object(a.jsx)("h1",{className:"info__title",children:t.name}),Object(a.jsx)("button",{type:"button",className:"info__edit-button",onClick:e.onEditProfile}),Object(a.jsx)("p",{className:"info__subtitle",children:t.about})]})]}),Object(a.jsx)("button",{type:"button",className:"profile__add-button",onClick:e.onAddPlace})]}),Object(a.jsx)("section",{className:"elements",children:e.cards.map((function(t){return Object(a.jsx)(x,{card:t,onCardClick:function(){return e.onCardClick(t)},onCardLike:function(){return e.onCardLike(t)},onCardDelete:function(){return e.onCardDelete(t)}},t._id)}))})]})};var N=function(){var e=(new Date).getFullYear();return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsxs)("p",{className:"footer__text",children:["\xa9 ",e," Mesto Russia"]})})};var v=function(e){return Object(a.jsx)("div",{className:"popup popup-img popup-".concat(e.name," ").concat(e.card&&"popup_opened"),children:Object(a.jsxs)("div",{className:"popup-img__container",children:[Object(a.jsx)("button",{type:"reset",className:"popup__reset popup-img__reset",onClick:e.onClose}),Object(a.jsxs)("figure",{className:"popup-img__figure",children:[Object(a.jsx)("img",{src:e.card&&e.card.link,alt:e.card&&"\u0424\u043e\u0442\u043e ".concat(e.card.name),className:"popup-img__image"}),Object(a.jsx)("figcaption",{className:"popup-img__caption",children:e.card&&e.card.name})]})]})})};var C=function(e){return Object(a.jsx)("div",{className:"popup popup-form popup-".concat(e.name," ").concat(e.isOpen?"popup_opened":""),children:Object(a.jsxs)("form",{onSubmit:e.onSubmit,method:"get",action:"index.html",name:e.name,className:"popup-form__container popup-edit__container",noValidate:!0,children:[Object(a.jsx)("button",{type:"reset",className:"popup__reset popup-".concat(e.name,"__reset"),onClick:e.onClose}),Object(a.jsx)("h2",{className:"popup-form__header",children:e.title}),e.children,Object(a.jsx)("button",{type:"submit",className:"popup-form__submit",children:e.btnName})]})})};var k=function(e){var t=s.a.useContext(O),n=s.a.useState(""),c=Object(l.a)(n,2),r=c[0],i=c[1],o=s.a.useState(""),u=Object(l.a)(o,2),d=u[0],p=u[1];return s.a.useEffect((function(){i(t.name),p(t.about)}),[t]),Object(a.jsx)(C,{onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:d})},isOpen:e.isOpen,onClose:e.onClose,name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",btnName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("label",{className:"popup-form__field",children:[Object(a.jsx)("input",{name:"profile-change",type:"text",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f",value:r,onChange:function(e){i(e.target.value)},id:"profile-name-input",className:"popup-form__input popup-edit__input_name",required:!0}),Object(a.jsx)("span",{className:"popup-form__input-error",id:"profile-name-input-error"})]}),Object(a.jsxs)("label",{className:"popup-form__field",children:[Object(a.jsx)("input",{name:"profile-change",type:"text",minLength:"2",maxLength:"200",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",value:d,onChange:function(e){p(e.target.value)},id:"profile-job-input",className:"popup-form__input popup-edit__input_job",required:!0}),Object(a.jsx)("span",{className:"popup-form__input-error",id:"profile-job-input-error"})]})]})})};var y=function(e){var t=s.a.useRef();return Object(a.jsx)(C,{onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar(t.current.value)},isOpen:e.isOpen,onClose:e.onClose,name:"edit-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",btnName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("label",{className:"popup-form__field",children:[Object(a.jsx)("input",{name:"profile-avatar-change",type:"url",ref:t,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430",id:"url-input",className:"popup-form__input popup-edit-avatar__input",required:!0}),Object(a.jsx)("span",{className:"popup-form__input-error",id:"url-input-error"})]})})})};var S=function(e){var t=s.a.useRef(),n=s.a.useRef();return Object(a.jsx)(C,{onSubmit:function(a){a.preventDefault(),e.onUpdateCards(t.current.value,n.current.value)},isOpen:e.isOpen,onClose:e.onClose,name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",btnName:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("label",{className:"popup-form__field",children:[Object(a.jsx)("input",{name:"card-add",type:"text",ref:t,minLength:"2",maxLength:"30",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"card-title-input",className:"popup-form__input popup-add__input_title",required:!0}),Object(a.jsx)("span",{className:"popup-form__input-error",id:"card-title-input-error"})]}),Object(a.jsxs)("label",{className:"popup-form__field",children:[Object(a.jsx)("input",{name:"card-add",type:"url",ref:n,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"card-url-input",className:"popup-form__input popup-add__input_url",required:!0}),Object(a.jsx)("span",{className:"popup-form__input-error",id:"card-url-input-error"})]})]})})},w=n(13),L=n(14),E=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},P=function(e){console.log(e)},T=new(function(){function e(t){Object(w.a)(this,e),this._url=t.url,this._headers=t.headers}return Object(L.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{method:"GET",headers:this._headers}).then(E).catch(P)}},{key:"getProfileInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then(E).catch(P)}},{key:"setProfileInfo",value:function(e,t){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(E).catch(P)}},{key:"setProfileAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(E).catch(P)}},{key:"createNewCard",value:function(e,t){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(E).catch(P)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(E).catch(P)}},{key:"changeLikeCardStatus",value:function(e,t){return t?fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(E).catch(P):fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(E).catch(P)}}]),e}())({url:"https://ndthwm.students.nomoreparties.space",headers:{authorization:"0f98b9d9-de6c-47c4-8011-fc8d2aa2d9ac","Content-Type":"application/json"}}),I=new(function(){function e(t){Object(w.a)(this,e),this._url=t.url,this._headers=t.headers}return Object(L.a)(e,[{key:"register",value:function(e,t){return fetch("".concat(this._url,"/signup"),{method:"POST",headers:this._headers,body:JSON.stringify({email:String(e),password:String(t)})}).then((function(e){return e.json()})).catch((function(e){return e}))}},{key:"authorize",value:function(e,t){return fetch("".concat(this._url,"/signin"),{method:"POST",headers:this._headers,body:JSON.stringify({email:String(e),password:String(t)})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e})).catch((function(e){return e}))}},{key:"checkToken",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return e}))}}]),e}())({url:"https://api.ndthwm.students.nomoreparties.space",headers:{"Content-Type":"application/json",Accept:"application/json"}}),A=n(23),D=n(24),U=function(e){var t=e.component,n=Object(D.a)(e,["component"]);return Object(a.jsx)(u.b,{children:function(){return n.loggedIn?Object(a.jsx)(t,Object(A.a)({},n)):Object(a.jsx)(u.a,{to:"./sign-in"})}})};var R=function(){var e=Object(u.g)(),t=s.a.useState(!1),n=Object(l.a)(t,2),c=n[0],r=n[1],i=s.a.useState(""),d=Object(l.a)(i,2),p=d[0],j=d[1];function _(){if(localStorage.getItem("jwt")){var t=localStorage.getItem("jwt");I.checkToken(t).then((function(t){j(t.data.email),r(!0),e.push("/")})).catch((function(e){console.log(e)}))}}s.a.useEffect((function(){_()}),[c]);var x=s.a.useState(!1),w=Object(l.a)(x,2),L=w[0],E=w[1],P=s.a.useState(!1),A=Object(l.a)(P,2),D=A[0],R=A[1],F=function(e){E(!L),R(e)},q=s.a.useState(!1),J=Object(l.a)(q,2),z=J[0],V=J[1],B=s.a.useState(!1),G=Object(l.a)(B,2),H=G[0],M=G[1],Y=s.a.useState(!1),K=Object(l.a)(Y,2),Q=K[0],W=K[1],X=s.a.useState(void 0),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=s.a.useState({name:"",about:"",avatar:""}),ne=Object(l.a)(te,2),ae=ne[0],ce=ne[1],se=s.a.useState([]),re=Object(l.a)(se,2),ie=re[0],oe=re[1],le=function(){M(!1),V(!1),W(!1),ee(void 0),E(!1)};return s.a.useEffect((function(){T.getProfileInfo().then((function(e){ce(e)})).catch((function(e){console.log(e)}))}),[]),s.a.useEffect((function(){T.getInitialCards().then((function(e){oe(e)})).catch((function(e){console.log(e)}))}),[]),Object(a.jsx)(O.Provider,{value:ae,children:Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(b,{userEmail:p,onSignOut:function(){r(!1)},history:e}),Object(a.jsxs)(u.d,{children:[Object(a.jsx)(u.b,{path:"/sign-up",children:Object(a.jsx)(f,{history:e,handleIsTooltipOpen:F,onRegister:function(t,n){I.register(t,n).then((function(t){t.data?(e.push("/sign-in"),F(!0)):F(!1),console.log(t)})).catch((function(e){console.log(e)}))}})}),Object(a.jsx)(u.b,{path:"/sign-in",children:Object(a.jsx)(h,{loggedIn:c,onLogin:function(t,n){I.authorize(t,n).then((function(t){t.token&&(r(!0),e.push("/"))})).catch((function(e){console.log(e)}))},tokenCheck:_,history:e})}),Object(a.jsx)(U,{path:"/",component:g,loggedIn:c,userEmail:p,onEditProfile:function(){return V(!z)},onAddPlace:function(){return M(!H)},onEditAvatar:function(){return W(!Q)},onCardClick:function(e){return ee(e)},cards:ie,onCardLike:function(e){return function(e){var t=e.likes.some((function(e){return e._id===ae._id}));T.changeLikeCardStatus(e._id,!t).then((function(t){var n=ie.map((function(n){return n._id===e._id?t:n}));oe(n)})).catch((function(e){console.log(e)}))}(e)},onCardDelete:function(e){return function(e){T.deleteCard(e._id).then((function(){var t=ie.filter((function(t){return t._id!==e._id}));oe(t)})).catch((function(e){console.log(e)}))}(e)}})]}),Object(a.jsx)(N,{}),Object(a.jsx)(k,{isOpen:z,onClose:le,onUpdateUser:function(e){T.setProfileInfo(e.name,e.about).then((function(e){ce(e),le()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(S,{isOpen:H,onClose:le,onUpdateCards:function(e,t){T.createNewCard(e,t).then((function(e){oe([e].concat(Object(o.a)(ie))),le()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(y,{isOpen:Q,onClose:le,onUpdateAvatar:function(e){T.setProfileAvatar(e).then((function(e){ce(e),le()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(v,{onClose:le,card:$}),Object(a.jsx)(m,{isRegisterSuccess:D,isOpen:L,onClose:le}),Object(a.jsx)(C,{name:"delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",btnName:"\u0414\u0430"})]})})};i.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(j.a,{children:Object(a.jsx)(R,{})})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.0bc6821b.chunk.js.map